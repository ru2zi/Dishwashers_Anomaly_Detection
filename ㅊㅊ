def preprocess_and_train(dataset, category, window_size, epochs, weight, weighting_func, section_threshold=None, peak_threshold=None):
    dataset = dataset.dropna(subset=['Category'])
    
    if category == 'EU':
        lstm_model, model_dif = preprocess_and_train_for_category(dataset, 'EU', window_size, epochs, weight, weighting_func, section_threshold, peak_threshold)
    elif category == 'US':
        lstm_model, model_dif = preprocess_and_train_for_category(dataset, 'US', window_size, epochs, weight, weighting_func, section_threshold, peak_threshold)
    else:
        raise ValueError(f"Unsupported category: {category}")

    return lstm_model, model_dif
